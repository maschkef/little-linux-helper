# =============================================================================
# DOCKER Â· DEFAULT PATTERN CHECKS
# =============================================================================
# @group Security
# @visibility advanced
#
# Regex helpers to flag weak passwords or placeholder secrets.
COMMON_WEAK_PASSWORD_REGEX="^(|(?i)(password|passwort|secret|geheim|admin|root|123456|12345678|qwerty|asdfgh|test|example|dummy|changeme|changeit|default|standard|pass|pwd|key|token|secretkey|apikey|mysql|postgres|mongo|redis|guest|mariadb|p[a@]\$\$w[o0]rd|r[o0]{2}t|adm[i1]n|geheim123|masterkey|masterpassword|yourpassword|your_password|temp|tmp|toor|rootpass|adminpass|user|username|login|access|secret_token|api_token|private_key|privatekey))$"
COMMON_PLACEHOLDER_KEY_REGEX="^(|(?i)(test|example|dummy|changeme|placeholder|your_api_key|your_secret_key|your_token|temp_key|temp_secret|temp_token|AKIAIOSFODNN7EXAMPLE|some[Rr]andom[Ss]tring|base64:.*))$"

# Variables to scan for insecure defaults. Format: VAR=regex,VAR2=regex
CFG_LH_DOCKER_DEFAULT_PATTERNS="PASSWORD=${COMMON_WEAK_PASSWORD_REGEX},"\
"MYSQL_ROOT_PASSWORD=${COMMON_WEAK_PASSWORD_REGEX},"\
"MYSQL_PASSWORD=${COMMON_WEAK_PASSWORD_REGEX},"\
"POSTGRES_PASSWORD=${COMMON_WEAK_PASSWORD_REGEX},"\
"ADMIN_PASSWORD=${COMMON_WEAK_PASSWORD_REGEX},"\
"REDIS_PASSWORD=${COMMON_WEAK_PASSWORD_REGEX},"\
"MONGO_INITDB_ROOT_PASSWORD=${COMMON_WEAK_PASSWORD_REGEX},"\
"RABBITMQ_DEFAULT_PASS=${COMMON_WEAK_PASSWORD_REGEX},"\
"ELASTIC_PASSWORD=${COMMON_WEAK_PASSWORD_REGEX},"\
"GF_SECURITY_ADMIN_PASSWORD=${COMMON_WEAK_PASSWORD_REGEX},"\
"KEYCLOAK_ADMIN_PASSWORD=${COMMON_WEAK_PASSWORD_REGEX},"\
"API_KEY=${COMMON_PLACEHOLDER_KEY_REGEX},"\
"SECRET_KEY=${COMMON_PLACEHOLDER_KEY_REGEX},"\
"TOKEN=${COMMON_PLACEHOLDER_KEY_REGEX},"\
"APP_KEY=${COMMON_PLACEHOLDER_KEY_REGEX}"
