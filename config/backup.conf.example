# config/backup.conf
# Copyright (c) 2025 maschkef
# SPDX-License-Identifier: MIT
#
# This file is part of the 'little-linux-helper' collection.
# Licensed under the MIT License. See the LICENSE file in the project root for more information.
#
# Little Linux Helper - Backup Configuration

# CFG_LH_BACKUP_ROOT:
# The absolute path to the root directory where backups should be stored.
# Example: "/mnt/external_drive" or "/srv/backups"
CFG_LH_BACKUP_ROOT="/run/media/tux/hdd_3tb/"

# CFG_LH_BACKUP_DIR:
# The name of the subdirectory within CFG_LH_BACKUP_ROOT where the actual backup data will be stored.
# Must start with "/". Example: "/my_system_backup"
CFG_LH_BACKUP_DIR="/backups"

# CFG_LH_TEMP_SNAPSHOT_DIR:
# An absolute path to a temporary directory used for BTRFS snapshots during the backup process.
# This directory should be on a BTRFS volume, ideally on the system itself if possible.
# IMPORTANT: Do NOT use Snapper (.snapshots) or Timeshift directories to avoid conflicts.
CFG_LH_TEMP_SNAPSHOT_DIR="/.snapshots_lh_temp"

# CFG_LH_RETENTION_BACKUP:
# The number of backup versions to keep (e.g., 10 means the 10 newest backups will be retained).
CFG_LH_RETENTION_BACKUP="10"

# CFG_LH_BACKUP_LOG_BASENAME:
# The base name for backup log files. A timestamp (YYMMDD-HHMM_) will be prepended to this name.
# Example: "backup.log" becomes "240730-1015_backup.log".
CFG_LH_BACKUP_LOG_BASENAME="backup.log"

# CFG_LH_TAR_EXCLUDES:
# Exclusion patterns for TAR-based backups (space-separated list).
# Example: "*.tmp *.log /var/cache"
CFG_LH_TAR_EXCLUDES=""

# CFG_LH_DEBUG_LOG_LIMIT:
# Maximum number of backup candidates to show in debug logs when listing existing backups.
# Set to 0 for unlimited (shows all existing backups in debug output).
# This only affects log verbosity, not backup functionality.
# Recommended: 10-20 for normal use, 0 for debugging issues.
CFG_LH_DEBUG_LOG_LIMIT="10"

# CFG_LH_KEEP_SOURCE_SNAPSHOTS:
# Controls whether source snapshots created by this script should be preserved after backup.
# Values: "prompt" (ask user during backup), "true" (always keep), "false" (always delete)
# When kept, snapshots are stored in CFG_LH_SOURCE_SNAPSHOT_DIR to avoid conflicts with other tools.
CFG_LH_KEEP_SOURCE_SNAPSHOTS="prompt"

# CFG_LH_SOURCE_SNAPSHOT_DIR:
# Directory for permanent source snapshots when CFG_LH_KEEP_SOURCE_SNAPSHOTS is enabled.
# This avoids conflicts with Snapper (/.snapshots) and Timeshift directories.
# Script-created snapshots are marked with metadata for identification and cleanup.
CFG_LH_SOURCE_SNAPSHOT_DIR="/.snapshots_lh"

# CFG_LH_SOURCE_SNAPSHOT_RETENTION:
# Number of preserved source snapshots per subvolume. Controls how many parent snapshots
# remain available for incremental chains after each backup completes.
# Set to 0 to disable preservation, 1 to keep only the latest parent, or higher for additional fallbacks.
CFG_LH_SOURCE_SNAPSHOT_RETENTION="1"

# CFG_LH_BACKUP_SUBVOLUMES:
# List of BTRFS subvolumes to backup (space-separated).
# Default: "@" "@home" (standard layout used by most distributions)
# 
# Examples:
#   Standard layout:     "@" "@home"
#   openSUSE layout:     "@" "@home" "@opt" "@srv" "@tmp" "@usr/local" "@var"
#   Arch Linux layout:   "@" "@home" "@var/log" "@var/cache/pacman/pkg"
#   Custom layout:       "@" "@home" "@docker" "@snapshots"
# 
# IMPORTANT: Each subvolume name should start with '@' and match your /etc/fstab entries.
# Use 'btrfs subvolume list /' to see available subvolumes on your system.
CFG_LH_BACKUP_SUBVOLUMES="@ @home"

# CFG_LH_AUTO_DETECT_SUBVOLUMES:
# Enable automatic detection of BTRFS subvolumes from /etc/fstab and /proc/mounts.
# Values: "true" (detect automatically), "false" (use CFG_LH_BACKUP_SUBVOLUMES only)
# When enabled, the script will scan for @-prefixed subvolumes commonly used for backups
# and merge them with the manually configured list above.
# Automatic detection helps ensure no important subvolumes are missed.
CFG_LH_AUTO_DETECT_SUBVOLUMES="true"
